<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teacher Dashboard | School Management System</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="css/common.css">
    <link rel="stylesheet" href="css/teacher.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect fill='%236a0dad' width='100' height='100' rx='50'/><text fill='%23ffffff' font-family='sans-serif' font-size='60' x='50' y='68' text-anchor='middle'>ðŸŽ’</text></svg>">
</head>
<body>
    <header>
        <div class="logo">
            <i class="fas fa-school"></i>
            <span> SCHOOL</span>
        </div>
        <div class="user-profile">
            <div class="user-avatar" id="userAvatar">T</div>
            <span id="userName">Loading...</span>
            <button onclick="logout()" class="logout-btn">Logout</button>
        </div>
    </header>

    <div class="container">
        <div class="tabs">
            <button class="tab-btn active" onclick="openTab('dashboard')">
                <i class="fas fa-tachometer-alt"></i> Dashboard
            </button>
            <button class="tab-btn" onclick="openTab('classes')">
                <i class="fas fa-chalkboard"></i> My Classes
            </button>
            <button class="tab-btn" onclick="openTab('students')">
                <i class="fas fa-user-graduate"></i> Students
            </button>
            <button class="tab-btn" onclick="openTab('attendance')">
                <i class="fas fa-clipboard-list"></i> Attendance
            </button>
            <button class="tab-btn" onclick="openTab('assignments')">
                <i class="fas fa-tasks"></i> Assignments
            </button>
            <button class="tab-btn" onclick="openTab('profile')">
                <i class="fas fa-user"></i> Profile
            </button>
        </div>

        <!-- Dashboard Tab -->
        <div id="dashboard" class="tab-content active">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="total-classes">0</div>
                    <div class="stat-label">Total Classes</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="total-students">0</div>
                    <div class="stat-label">Total Students</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="total-assignments">0</div>
                    <div class="stat-label">Total Assignments</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="attendance-rate">0%</div>
                    <div class="stat-label">Average Attendance</div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2 class="card-title"><i class="fas fa-calendar"></i> Today's Schedule</h2>
                </div>
                <div class="card-body">
                    <div class="schedule-list" id="schedule-list">
                        <div class="loading">Loading schedule...</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Classes Tab -->
        <div id="classes" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title"><i class="fas fa-chalkboard"></i> My Classes</h2>
                </div>
                <div class="card-body">
                    <div id="classes-list" class="classes-grid">
                        <div class="loading">Loading classes...</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Students Tab -->
        <div id="students" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title"><i class="fas fa-user-graduate"></i> My Students</h2>
                </div>
                <div class="card-body">
                    <div id="students-list" class="students-grid">
                        <div class="loading">Loading students...</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Attendance Tab -->
        <div id="attendance" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title"><i class="fas fa-clipboard-list"></i> Attendance Management</h2>
                    <button class="btn btn-primary" onclick="takeAttendance()">
                        <i class="fas fa-plus"></i> Take Attendance
                    </button>
                </div>
                <div class="card-body">
                    <div class="attendance-filters">
                        <select id="attendance-class" onchange="updateAttendanceList(this.value)">
                            <option value="">Select Class</option>
                        </select>
                        <input type="date" id="attendance-date" onchange="updateAttendanceList(document.getElementById('attendance-class').value)">
                    </div>
                    <div id="attendance-list" class="attendance-list">
                        <div class="loading">Select a class and date to view attendance...</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Assignments Tab -->
        <div id="assignments" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title"><i class="fas fa-tasks"></i> Assignment Management</h2>
                    <button class="btn btn-primary" onclick="createAssignment()">
                        <i class="fas fa-plus"></i> Create Assignment
                    </button>
                </div>
                <div class="card-body">
                    <div id="assignments-list" class="assignments-grid">
                        <div class="loading">Loading assignments...</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Profile Tab -->
        <div id="profile" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title"><i class="fas fa-user"></i> My Profile</h2>
                    <button class="btn btn-primary" onclick="showUpdateProfileModal()">
                        <i class="fas fa-edit"></i> Edit Profile
                    </button>
                </div>
                <div class="card-body">
                    <div id="profile-content" class="profile-content">
                        <div class="profile-info">
                            <p><strong>Name:</strong> <span id="profile-name">Loading...</span></p>
                            <p><strong>Email:</strong> <span id="profile-email">Loading...</span></p>
                            <p><strong>Phone:</strong> <span id="profile-phone">Loading...</span></p>
                            <p><strong>Subjects:</strong> <span id="profile-subjects">Loading...</span></p>
                            <p><strong>Qualification:</strong> <span id="profile-qualification">Loading...</span></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Create Assignment Modal -->
    <div id="create-assignment-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Create Assignment</h2>
                <span class="close-modal" onclick="closeModal('create-assignment-modal')">&times;</span>
            </div>
            <form id="create-assignment-form" onsubmit="event.preventDefault(); createAssignment();">
                <div class="form-row">
                    <div class="form-group">
                        <label for="assignment-title">Title</label>
                        <input type="text" id="assignment-title" name="title" required>
                    </div>
                    <div class="form-group">
                        <label for="assignment-class">Class</label>
                        <select id="assignment-class" name="classId" required>
                            <option value="">Select Class</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="assignment-due-date">Due Date</label>
                        <input type="datetime-local" id="assignment-due-date" name="dueDate" required>
                    </div>
                </div>
                <div class="form-group">
                    <label for="assignment-description">Description</label>
                    <textarea id="assignment-description" name="description" rows="4" required></textarea>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn" onclick="closeModal('create-assignment-modal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Create Assignment</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Update Profile Modal -->
    <div id="update-profile-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Update Profile</h2>
                <span class="close-modal" onclick="closeModal('update-profile-modal')">&times;</span>
            </div>
            <form id="update-profile-form" onsubmit="event.preventDefault(); updateProfile();">
                <div class="form-group">
                    <label for="profile-phone-input">Phone</label>
                    <input type="tel" id="profile-phone-input" name="phone" required>
                </div>
                <div class="form-group">
                    <label for="profile-subjects-input">Subjects (comma-separated)</label>
                    <input type="text" id="profile-subjects-input" name="subjects" required>
                </div>
                <div class="form-group">
                    <label for="profile-qualification-input">Qualification</label>
                    <input type="text" id="profile-qualification-input" name="qualification" required>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn" onclick="closeModal('update-profile-modal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Update Profile</button>
                </div>
            </form>
        </div>
    </div>

    <script src="js/auth.js"></script>
    <script src="js/teacher.js"></script>
</body>
</html>